<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Toplantƒ± Tutanaƒüƒ± Yazdƒ±r</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 12pt;
            line-height: 1.6;
            color: #1F2937;
            background: #F5F5F5;
            margin: 0;
            padding: 20px;
        }

        /* A4 Kaƒüƒ±t Sim√ºlasyonu */
        .page {
            background: white;
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            padding: 20mm 25mm; /* Standart A4 kenar bo≈üluklarƒ± */
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            box-sizing: border-box;
            position: relative;
        }

        /* Ba≈ülƒ±k Alanƒ± */
        .header {
            text-align: center;
            border-bottom: 3px solid #F97316;
            padding-bottom: 20px;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%);
            color: #1E293B;
            padding: 30px 20px;
            border-radius: 8px;
            border: 2px solid #FED7AA;
            box-shadow: 0 2px 8px rgba(249, 115, 22, 0.1);
        }
        .header h1 { 
            font-family: 'Playfair Display', serif;
            font-size: 20pt; 
            margin: 0; 
            text-transform: uppercase; 
            letter-spacing: 2px; 
            font-weight: 700; 
            color: #9A3412;
        }
        .header h2 { 
            font-size: 13pt; 
            margin: 10px 0 0 0; 
            font-weight: 500; 
            color: #C2410C;
        }
        
        .meta-info {
            width: 100%;
            margin-bottom: 20px;
            border-collapse: collapse;
        }
        .meta-info td { 
            padding: 8px 5px; 
            vertical-align: top; 
            border-bottom: 1px solid #F1F5F9;
        }
        .meta-label { 
            font-weight: 600; 
            width: 120px; 
            color: #475569;
        }

        /* ƒ∞√ßerik */
        .agenda-item { 
            margin-bottom: 30px; 
            border: 2px solid #FED7AA;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(249, 115, 22, 0.1);
            background: white;
        }
        .agenda-title { 
            font-size: 14pt; 
            font-weight: 700; 
            background: linear-gradient(135deg, #F97316 0%, #EA580C 100%);
            color: white;
            border-bottom: 2px solid #EA580C;
            padding: 16px 20px;
            margin-bottom: 0;
            display: flex; 
            justify-content: space-between;
            align-items: center;
        }
        .agenda-title span:first-child {
            flex: 1;
        }
        .agenda-responsible {
            font-size: 10pt;
            background: rgba(255,255,255,0.25);
            color: white;
            padding: 6px 14px;
            border-radius: 6px;
            margin-left: 12px;
            font-weight: 600;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .agenda-content-wrapper {
            padding: 20px;
            background: #FFFFFF;
        }
        
        .content-list { 
            margin: 10px 0; 
            padding-left: 25px; 
            list-style-type: disc; 
        }
        .content-list li { 
            margin-bottom: 6px; 
            color: #374151;
            line-height: 1.6;
        }

        /* Kararlar */
        .decisions-box {
            border: 2px solid #F97316;
            background: linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%);
            padding: 20px;
            margin-top: 20px;
            border-radius: 8px;
            page-break-inside: avoid;
            box-shadow: 0 2px 6px rgba(249, 115, 22, 0.1);
        }
        .decision-header { 
            font-weight: 700; 
            font-size: 12pt;
            color: #9A3412;
            margin-bottom: 16px; 
            display: block;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #F97316;
            padding-bottom: 8px;
            font-family: 'Playfair Display', serif;
        }
        .decision-row { 
            margin-bottom: 12px; 
            padding: 12px 16px;
            background: white;
            border-left: 4px solid #F97316;
            border-radius: 6px;
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 12px;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .decision-label {
            font-size: 10pt;
            font-weight: 700;
            color: #F97316;
            background: #FFF7ED;
            padding: 4px 10px;
            border-radius: 4px;
            white-space: nowrap;
            border: 1px solid #FED7AA;
        }
        .decision-text {
            color: #1F2937;
            font-weight: 500;
            line-height: 1.6;
            word-wrap: break-word;
            min-width: 0;
        }
        .responsible-tag { 
            font-weight: 600; 
            color: #9A3412;
            background: #FED7AA;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 9pt;
            white-space: nowrap;
            border: 1px solid #F97316;
        }

        /* Tablo Stili */
        .print-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 12px 0; 
            font-size: 11pt;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(249, 115, 22, 0.1);
            border: 2px solid #FED7AA;
        }
        .print-table th, .print-table td { 
            border: 1px solid #FED7AA; 
            padding: 12px 14px; 
            text-align: left; 
        }
        .print-table th { 
            background: linear-gradient(135deg, #F97316 0%, #EA580C 100%);
            color: white;
            font-weight: 700;
            border-bottom: 2px solid #EA580C;
        }
        .print-table tr:nth-child(even) {
            background: #FFF7ED;
        }
        .print-table tr:hover {
            background: #FFEDD5;
        }


        /* Yazdƒ±rma Butonu */
        .no-print {
            position: fixed; top: 20px; right: 20px;
            background: #333; color: white; padding: 10px 20px;
            text-decoration: none; border-radius: 5px; font-family: sans-serif; cursor: pointer;
        }

        /* YAZDIRMA AYARLARI (@media print) */
        @media print {
            body { background: white; padding: 0; }
            .page { width: 100%; margin: 0; padding: 0; box-shadow: none; border: none; }
            .no-print { display: none; }
            .agenda-title { 
                background: linear-gradient(135deg, #F97316 0%, #EA580C 100%) !important;
                color: white !important;
            }
            /* Arka plan grafiklerini yazdƒ±rmaya zorlamak i√ßin (Chrome/Edge) */
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
    </style>
</head>
<body>

    <button class="no-print" onclick="window.print()">üñ®Ô∏è Yazdƒ±r / PDF Kaydet</button>

    <div class="page">
        <div class="header">
            <h1>Karaaƒüa√ß Fatih</h1>
            <h2>Yurt Personel Toplantƒ± Tutanaƒüƒ±</h2>
        </div>

        <table class="meta-info">
            <tr>
                <td class="meta-label">Tarih:</td>
                <td id="print-date">...</td>
                <td class="meta-label">Saat:</td>
                <td id="print-time">...</td>
            </tr>
            <tr>
                <td class="meta-label">Katƒ±lƒ±mcƒ±lar:</td>
                <td colspan="3">T√ºm ƒ∞dari ve Eƒüitim Personeli</td>
            </tr>
        </table>

        <div id="document-body"></div>
    </div>

    <script>
        // Veri Kaynaƒüƒ± (Y√∂netici Paneliyle aynƒ± olmalƒ±)
        // Normalde ortak bir data.js dosyasƒ±ndan √ßekmek en doƒürusudur.
        // Buraya SLIDES verisini tekrar ekliyoruz ki baƒüƒ±msƒ±z √ßalƒ±≈üabilsin.
        const SLIDES = [
            {
                baslik: "1. Sohbet Tekrarƒ± ve Personel Arasƒ± Ders",
                icerik: ["Muhterem B√ºy√ºƒü√ºm√ºz√ºn sohbetinin okunduƒüu (07.11.2025)", "Kur'an-ƒ± Kerim 13.c√ºz okundu."]
            },
            {
                baslik: "2. Talebe Hizmetlerimiz",
                icerik: ["Kƒ±raat ve ≈ûifahi imtihan neticelerinin deƒüerlendirilmesi", "10 Ocak: Kudur-i ≈ûerif imtihanƒ±", "Takrir takibi: karaagacfatih.netlify.app", "Yemekhane fare ila√ßlamasƒ±nƒ±n tekrarlanmasƒ±"]
            },
            {
                baslik: "3. Nehari Hizmeti",
                icerik: ["Toplam 17 nehari talebemiz var (3, 4 ve 5. Sƒ±nƒ±flar)", "Ak√ßaburgaz kursuna ge√ßen 5 talebenin takibi", "Kasƒ±m ara tatili: Matematik kul√ºb√º"]
            },
            {
                baslik: "6. Fazilet Takvimi & Dergi",
                tablo: true,
                icerik: [
                    {ad: "Blok Takvim", hedef: "1500", siparis: "400"},
                    {ad: "Ciltli Takvim", hedef: "500", siparis: "500"},
                    {ad: "Mobil Takvim", hedef: "820", siparis: "100"}
                ]
            },
            {
                baslik: "8. Mali ƒ∞≈üler",
                icerik: ["2024-2025 alacaklarƒ±n incelenmesi", "Muhacir talebelerin resmiyet i≈ülemleri", "27 Kasƒ±m: √áapraz denetim"]
            }
        ];

        function renderDocument() {
            // Tarih Saat
            const now = new Date();
            document.getElementById('print-date').innerText = now.toLocaleDateString('tr-TR', { day: 'numeric', month: 'long', year: 'numeric' });
            document.getElementById('print-time').innerText = now.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });

            // Kararlarƒ± localStorage'dan √ßek - √∂nce toplanti_kararlari, sonra karaagac_meeting_data
            let savedDecisions = JSON.parse(localStorage.getItem('toplanti_kararlari') || '{}');
            const meetingData = JSON.parse(localStorage.getItem('karaagac_meeting_data') || '{}');
            
            // Eƒüer meetingData varsa onu kullan
            if(meetingData.decisions) {
                savedDecisions = meetingData.decisions;
            }
            
            // SLIDES verisini de meetingData'dan al
            const slides = meetingData.slides || SLIDES;
            const container = document.getElementById('document-body');

            slides.forEach((slide, index) => {
                let html = `<div class="agenda-item">`;
                
                // Ba≈ülƒ±k
                html += `<div class="agenda-title">
                    <span>${slide.baslik}</span>
                    ${slide.sorumlu ? `<span class="agenda-responsible">${slide.sorumlu}</span>` : ''}
                </div>`;

                html += `<div class="agenda-content-wrapper">`;

                // ƒ∞√ßerik
                if (slide.tablo) {
                    html += `<table class="print-table"><thead><tr><th>√úr√ºn</th><th>Hedef</th><th>Sipari≈ü</th></tr></thead><tbody>`;
                    slide.icerik.forEach(r => {
                        html += `<tr><td>${r.ad || ''}</td><td>${r.hedef || ''}</td><td>${r.siparis || ''}</td></tr>`;
                    });
                    html += `</tbody></table>`;
                } else {
                    html += `<ul class="content-list">`;
                    slide.icerik.forEach(item => {
                        const isObject = typeof item === 'object' && item !== null;
                        const text = isObject ? item.text : item;
                        html += `<li>${text}</li>`;
                    });
                    html += `</ul>`;
                }

                // --- KARARLAR ---
                const decisions = savedDecisions[index] || [];
                if (decisions.length > 0) {
                    html += `<div class="decisions-box">
                        <span class="decision-header">Alƒ±nan Kararlar:</span>`;
                    decisions.forEach(d => {
                        const personText = d.person ? d.person : '';
                        html += `
                            <div class="decision-row">
                                <span class="decision-label">KARAR</span>
                                <span class="decision-text">${d.text || ''}</span>
                                ${personText ? `<span class="responsible-tag">${personText}</span>` : '<span></span>'}
                            </div>`;
                    });
                    html += `</div>`;
                }

                html += `</div></div>`; // agenda-content-wrapper ve agenda-item kapat
                container.innerHTML += html;
            });
        }

        renderDocument();
    </script>
</body>
</html>